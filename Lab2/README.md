# Лабораторная работа 2: Работа с коллекциями

## Описание

Лабораторная работа посвящена анализу и сравнению производительности операций над различными типами коллекций в .NET: `List<T>`, `LinkedList<T>`, `Queue<T>`, `Stack<T>` и `ImmutableList<T>`.

## Цель работы

Проанализировать и сравнить производительность операций над коллекциями для понимания их особенностей и выбора оптимальной структуры данных в зависимости от сценария использования.

## Требования

- .NET 9.0 SDK
- Операционная система: Windows, macOS или Linux

## Структура проекта

```
Lab2/
├── Lab2.csproj              # Основной проект
├── Program.cs                # Точка входа, запуск бенчмарков и генерация отчета
├── PerformanceBenchmark.cs   # Класс для измерения производительности
├── Lab2.Tests/              # Тестовый проект
│   ├── Lab2.Tests.csproj
│   └── UnitTest1.cs         # Тесты корректности операций
└── README.md                 # Этот файл
```

## Тестируемые коллекции

1. **List<T>** - динамический массив
2. **LinkedList<T>** - двусвязный список
3. **Queue<T>** - очередь (FIFO)
4. **Stack<T>** - стек (LIFO)
5. **ImmutableList<T>** - неизменяемый список

## Тестируемые операции

Для каждой коллекции измеряется производительность следующих операций:

- **Добавление элементов**:
  - В конец коллекции
  - В начало коллекции
  - В середину коллекции

- **Удаление элементов**:
  - Из конца коллекции
  - Из начала коллекции
  - Из середины коллекции

- **Поиск элемента** по значению

- **Получение элемента по индексу** (если применимо)

## Параметры тестирования

- **Размер коллекций**: 100,000 элементов
- **Количество итераций**: 5 измерений с последующим усреднением
- **Прогрев**: 3 итерации для стабилизации JIT-компиляции
- **Инструмент измерения**: `System.Diagnostics.Stopwatch`

## Установка и запуск

### 1. Восстановление зависимостей

```bash
cd Lab2
dotnet restore
```

### 2. Запуск тестов корректности

Перед запуском бенчмарков рекомендуется убедиться, что все операции работают корректно:

```bash
cd Lab2.Tests
dotnet test
```

### 3. Запуск бенчмарков производительности

Для запуска замеров производительности:

```bash
cd Lab2
dotnet run
```

Результаты будут выведены в консоль в виде таблиц с результатами для каждой операции.

## Результаты

### Где найти результаты

После запуска `dotnet run` результаты будут выведены в консоль в виде таблиц, сгруппированных по операциям. Каждая таблица содержит:

- Название коллекции
- Среднее время выполнения (мс)
- Минимальное время (мс)
- Максимальное время (мс)

Результаты отсортированы по производительности (от быстрейших к медленнейшим) для каждой операции.

## Тесты корректности

Проект включает автоматизированные тесты на xUnit, которые проверяют:

- ✅ Корректность добавления элементов во все позиции
- ✅ Корректность удаления элементов из всех позиций
- ✅ Корректность поиска элементов
- ✅ Корректность доступа по индексу
- ✅ Сохранение порядка элементов (для Queue и Stack)
- ✅ Неизменяемость ImmutableList

Все тесты детерминированы и воспроизводимы.

## Примеры использования

### Запуск только тестов

```bash
cd Lab2.Tests
dotnet test --verbosity normal
```

### Запуск бенчмарков с выводом в консоль

```bash
cd Lab2
dotnet run
```

### Сборка проекта

```bash
cd Lab2
dotnet build
```

## Технические детали

### Используемые технологии

- **.NET 9.0** - платформа разработки
- **xUnit** - фреймворк для тестирования
- **System.Collections.Immutable** - пакет для ImmutableList
- **System.Diagnostics.Stopwatch** - для измерения времени

### Особенности реализации

1. **Прогрев JIT**: Перед измерениями выполняется 3 итерации для стабилизации JIT-компиляции
2. **Множественные измерения**: Каждая операция выполняется 5 раз для получения статистически значимых результатов
3. **Усреднение**: Результаты усредняются для уменьшения влияния случайных факторов
4. **Изоляция тестов**: Каждый тест использует отдельные экземпляры коллекций

## Выводы

На основе результатов замеров можно сделать следующие выводы:

- **List<T>** оптимален для частого доступа по индексу и добавления в конец
- **LinkedList<T>** эффективен для частых вставок/удалений в середине
- **Queue<T>** и **Stack<T>** специализированы для своих сценариев (FIFO/LIFO)
- **ImmutableList<T>** обеспечивает thread-safety, но имеет накладные расходы на производительность

Подробные выводы и рекомендации можно найти в файле `Report.md` (если он был создан ранее).

## Автор

Лабораторная работа выполнена в рамках изучения структур данных и коллекций в .NET.

## Лицензия

Учебный проект.

